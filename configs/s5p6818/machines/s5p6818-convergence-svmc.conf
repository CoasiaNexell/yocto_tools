#MACHINE = "s5p6818-convergence-svmc"
DL_DIR = "${TOPDIR}/../downloads"
SSTATE_DIR = "${TOPDIR}/sstate-cache"
DISTRO_FEATURES_append = " \
    nexell-convergence-svmc \
    no-use-tslib \
    support-nx-init \
    swupdate \
    "

PREFERRED_VERSION_swupdate ?= "2019.11"

PART_MISC_SIZE="16M"
PART_MISC_NODE="/dev/mmcblk0p3"
SWU_SUPPORT_MAKE_SWU_IMAGE="true"
SWU_DAEMON_SERVICES_REPLACE="true"
SWU_SERVICE_SWUPDATE_ROOT="/usr/bin/swupdate -k /misc/etc/swu.public.key -i /swu/*.swu -v -l6 -n"
SWU_SERVICE_PROGRESS_ROOT="/usr/bin/swupdate-progress -r -w -m recovery"
SWU_SERVICE_SWUPDATE_RECOVERY="/usr/bin/swupdate -k /misc/etc/swu.public.key -i /swu/*.swu -v -l6"
SWU_SERVICE_PROGRESS_RECOVERY="/usr/bin/swupdate-progress -r -w -p"
SWU_PROGRESS_PSPLASH ?= "true"
SWU_TOOL_IMAGE_GEN = "swu_image.sh"

PART_DATA_SIZE = "6G"
PART_DATA_NODE = "/dev/mmcblk0p6"

NEXELL_BOARD_NAME = "convergence_svmc"
NEXELL_BL1_BOARD_NAME = "convergence"
NEXELL_BL1_IMAGE_NAME = "convergence"
# RAM Size : "512mb" , "1g", "2g"
#NEXELL_MEM_SIZE = "2g"

# ------------------------------------------------------------
# Nexell Kernel Configuration
# ------------------------------------------------------------
KERNEL_DEVICETREE = "nexell/s5p6818-convergence_svmc-rev01.dtb"
KERNEL_DTB_NAME = "s5p6818-convergence_svmc-rev01.dtb"

# ------------------------------------------------------------
# Nexell optee Configuration, only s5p6818
# ------------------------------------------------------------
OPTEE_PLAT_DRAM_SIZE="2048"
OPTEE_PLAT_UART_BASE="0xC00A3000"

# ------------------------------------------------------------
# ROOTFS Size
# ------------------------------------------------------------
# $fastboot getvar capacity.mmc.0
# 7818182656 - 0x4400000 = 7746879488
# Available rootfs Size = 7565312 Kbyte
# ------------------------------------------------------------
# Reserved yocto extra space = 102400 Kbyte for pkg. install
# IMAGE_ROOTFS_EXTRA_SPACE="0 + 102400"
# ------------------------------------------------------------
# So, 7565312 - 102400 = 7462912 Kbyte
# DAUDIO 768MB, 786432 - 102400 = 684032 Kbyte
# ------------------------------------------------------------
IMAGE_ROOTFS_SIZE = "684032"

# ------------------------------------------------------------
# Nexell Etc Configuration
# ------------------------------------------------------------
# override touch class, capacitive touchscreen
NEXELL_TOUCH_CLASS = "CAPACITIVE"


NEXELL_USER_PARTITION_SIZE ?= "4G"
NEXELL_ROOT_PARTITION_SIZE ?= "3221225472"

# ------------------------------------------------------------
# Nexell Etc Configuration
# ------------------------------------------------------------
# Nexell override
SERIAL_CONSOLE = "115200 ttySAC0"

UBOOT_BOOTARGS ?= "console=ttySAC0,115200n8"
UBOOT_BOOTARGS += "root=\/dev\/mmcblk0p5 rw rootfstype=ext4"
UBOOT_BOOTARGS += "init=\/sbin\/nx_init loglevel=4 quiet rootwait printk.time=1"
UBOOT_BOOTARGS += "misc_part=\/dev\/mmcblk0p3"
UBOOT_BOOTARGS += "consoleblank=0 coherent_pool=4M systemd.log_level=info"
UBOOT_BOOTARGS += "systemd.show_status=false"
UBOOT_BOOTARGS += "nx_drm.fb_buffers=3 nx_drm.fb_pan_crtcs=0x1"
UBOOT_BOOTARGS += "nx_drm.fb_conns=1 nx_drm.fb_argb=1"

UBOOT_RECOVERYBOOT_ARGS ?= "setenv bootargs console=ttySAC0,115200n8"
UBOOT_RECOVERYBOOT_ARGS += "root=\/dev\/ram0 loglevel=4 printk.time=1"
UBOOT_RECOVERYBOOT_ARGS += "consoleblank=0"
UBOOT_RECOVERYBOOT_ARGS += "rdinit=\/sbin\/nx_init"
UBOOT_RECOVERYBOOT_ARGS += "misc_part=\/dev\/mmcblk0p3"
UBOOT_RECOVERYBOOT_ARGS += "nx_drm.fb_buffers=3 nx_drm.fb_pan_crtcs=0x1"
UBOOT_RECOVERYBOOT_ARGS += "nx_drm.fb_conns=1 nx_drm.fb_argb=0;"
UBOOT_RECOVERYBOOT_ARGS += "ext4load mmc 0:1 0x40080000 Image;"
UBOOT_RECOVERYBOOT_ARGS += "ext4load mmc 0:1 0x48000000 uInitrd;"
UBOOT_RECOVERYBOOT_ARGS += "ext4load mmc 0:1 0x55000000 s5p6818-convergence_svmc-rev01.dtb;"
UBOOT_RECOVERYBOOT_ARGS += "booti 0x40080000 0x48000000 0x55000000;"

# For daudio sdk
NEXELL_SDK_HEADER_FILE ?= "${BSP_ROOT_DIR}/layers/meta-nexell/meta-nexell-distro/recipes-solutions/nexell-sdk/files"